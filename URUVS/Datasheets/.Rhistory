URUV_data$SITE_TYPE <- factor(URUV_data$SITE_TYPE, levels = c("D", "E", "L"))
URUV_data$DESA <- factor(URUV_data$DESA)
# COMBINING SPECIES ORIGINALLY SEPARATED IN DATA - THIS NEEDS TO BE BEFORE CHANGING ALL COLUMNS TO READ AS TIMES!!!
combineSpecies("FISHF", "GUPPYC", "FISHF")
combineSpecies("FISHM", "FISHG", "FISHM")
combineSpecies("FISHL", "FISHK", "FISHK")
#Change all time columns to be read as times
for(i in 1:ncol(URUV_data)){
if(colnames(URUV_data[i]) %in% c("TIME_DROPPED", "TIME_PICKEDUP", "TIME_TOTALFOOTAGE")){
#URUV_data[[i]] <- strptime(URUV_data[[i]], format = "%H:%M")
URUV_data[[i]] <- times(paste0(URUV_data[[i]], ":00"))
}
else if(colnames(URUV_data[i]) != "NOTES_TIME" & (colnames(URUV_data[i]) %in% c("TOTALTIME_RECORDING", "ANALYSISTIME_START", "ANALYSISTIME_END", "TOTALTIME_ANALYSIS") | grepl("_TIME", colnames(URUV_data[i])) | grepl("TIME_1ST", colnames(URUV_data[i])) | grepl("T1_", colnames(URUV_data[i])))){
URUV_data[[i]] <- times(URUV_data[[i]])
}
}
#TotalMaxN and Shannon's Diversity for each observation
dontInclude <- c("UNIDGUPPY", "PIPEFISH", "TOTAL")
for(i in 1:nrow(URUV_data)){
species_counts <- c()
k <- 1
for(j in 1:ncol(URUV_data)){
if(grepl(paste(dontInclude, collapse = "|"), colnames(URUV_data[j])) == FALSE & grepl("MAXN", colnames(URUV_data[j])) & URUV_data[i,j] > 0){
species_counts[k] <- URUV_data[i,j]
k <- k+1
}
}
species_proportions <- species_counts / sum(species_counts)
shannon_diversity <- -sum(species_proportions * log(species_proportions))
URUV_data$SHANNON_DIV[i] <- shannon_diversity
URUV_data$MAXN_TOTAL[i] <- sum(species_counts)
}
checkData <- URUV_data %>%
select(SHANNON_DIV, MAXN_TOTAL, NO_FISHSPECIES, contains("MAXN"))
# # COMBINING SPECIES ORIGINALLY SEPARATED IN DATA
# combineSpecies("FISHF", "GUPPYC", "FISHF")
# combineSpecies("FISHM", "FISHG", "FISHM")
# combineSpecies("FISHL", "FISHK", "FISHK")
write.csv(URUV_data, "MasterRecordingData_clean.csv")
ggplot(URUV_data, aes(x=DESA, y=NO_ALLSPECIES)) +
geom_boxplot()
ggplot(URUV_data, aes(x=SITE_TYPE, y=NO_ALLSPECIES)) +
geom_boxplot()
ggplot(URUV_data, aes(x=DESA, y=NO_FISHSPECIES)) +
geom_boxplot()
ggplot(URUV_data, aes(x=SITE_TYPE, y=NO_FISHSPECIES)) +
geom_boxplot()
shannon <- URUV_data %>%
group_by(SITE_TYPE) %>%
summarise(SHANNON_AVG = mean(SHANNON_DIV))
ggplot(data=shannon, aes(x=SITE_TYPE, y=SHANNON_AVG, fill = SITE_TYPE)) +
geom_bar(stat="identity", color = "black") +
xlab("Jenis Mangrove") +
ylab("Index") +
#geom_text(aes(label=SHANNON_AVG), vjust=-0.3, size=3.5) +
theme_minimal() +
scale_fill_manual(values = c("#b41515", "#ffff00", "#0474c4"),
labels = c("Dihancur","EMR", "Alami")) +
theme(legend.title=element_blank())
ggplot(URUV_data, aes(x=DESA, y=MAXN_TOTAL)) +
geom_boxplot()
ggplot(URUV_data, aes(x=SITE_TYPE, y=MAXN_TOTAL)) +
geom_boxplot()
one.way_Overall <- aov(MAXN_TOTAL ~ SITE_TYPE, data = URUV_data)
summary(one.way_Overall)
one.way_Desa <- aov(MAXN_TOTAL ~ DESA, data = URUV_data)
summary(one.way_Desa)
two.way_Overall <- aov(SHANNON_DIV ~ SITE_TYPE + DESA, data = URUV_data)
summary(two.way_Overall)
Interaction_Overall <- aov(SHANNON_DIV ~ SITE_TYPE * DESA, data = URUV_data)
summary(Interaction_Overall)
ggplot(data=URUV_data, aes(x=WATER_DEPTH_BEFORE, y=MAXN_TOTAL)) +
geom_smooth(method="lm") +
geom_point() +
stat_regline_equation(label.x=15, label.y=50) +
stat_cor(aes(label=..rr.label..), label.x=15, label.y=40)
ggplot(data=URUV_data, aes(x=TIDE_HEIGHT, y=MAXN_TOTAL)) +
geom_smooth(method="lm") +
geom_point() +
stat_regline_equation(label.x=.1, label.y=50) +
stat_cor(aes(label=..rr.label..), label.x=.1, label.y=40)
ggplot(data=URUV_data, aes(x=VEGITATION, y=MAXN_TOTAL)) +
geom_smooth(method="lm") +
geom_point() +
stat_regline_equation(label.x=15, label.y=50) +
stat_cor(aes(label=..rr.label..), label.x=15, label.y=40)
plot(URUV_data$VISIBILITY, URUV_data$MAXN_TOTAL)
ggplot(data=URUV_data, aes(x=VISIBILITY, y=MAXN_TOTAL)) +
geom_smooth(method="lm") +
geom_point() +
stat_regline_equation(label.x=15, label.y=50) +
stat_cor(aes(label=..rr.label..), label.x=15, label.y=40)
StackedBar <- URUV_data %>%
group_by(MONTH, SITE_TYPE) %>%
summarise(JUMLAH_IKAN = sum(MAXN_TOTAL), SHANNON_MEAN = mean(SHANNON_DIV))
ggplot(StackedBar, aes(fill=SITE_TYPE, y=JUMLAH_IKAN, x=MONTH)) +
geom_bar(position="stack", stat="identity", color = "black") +
xlab("Bulan") +
ylab("Jumlah Ikan") +
theme_minimal() +
scale_fill_manual(values = c("#b41515", "#ffff00", "#0474c4"),
labels = c("Dihancur","EMR", "Alami")) +
theme(legend.title=element_blank())
ggplot(StackedBar, aes(fill=SITE_TYPE, y=SHANNON_MEAN, x=MONTH)) +
geom_bar(position="stack", stat="identity", color = "black") +
xlab("Bulan") +
ylab("SDI") +
theme_minimal() +
scale_fill_manual(values = c("#b41515", "#ffff00", "#0474c4"),
labels = c("Dihancur","EMR", "Alami")) +
theme(legend.title=element_blank())
colList <- c()
#REMOVE SPECIES IN DONT INCLUDE FROM HERE
for(i in 1:ncol(URUV_data)){
if(grepl("MAXN", colnames(URUV_data[i])) & sum(URUV_data[i] > 0) > 20){ #Sort Through all MaxN's calculated
colList <- append(colList, i)
# & sum(colnames(URUV_data[i]) > 0) > 5
#Need to fully rename column so ggplot can read it. Make separate datasheet
Yaxistitle <- colnames(URUV_data[i])
data1 <- URUV_data %>%
rename("MAXN_TARGET" = colnames(URUV_data[i]))
#data1$MONTH <- month(data1$DATE)
#Graph boxplot per desa
print(ggplot(data1, aes(x=DESA, y=MAXN_TARGET)) +
geom_boxplot() +
geom_jitter(shape=16, position=position_jitter(0.2)) +
ylab(Yaxistitle))
#Graph boxplot per site type
print(ggplot(data1, aes(x=SITE_TYPE, y=MAXN_TARGET)) +
geom_boxplot() +
geom_jitter(shape=16, position=position_jitter(0.2)) +
ylab(Yaxistitle))
#Graph temporal patterns
SpeciesPerMonth <- data1 %>%
group_by(MONTH) %>%
summarize(sum(MAXN_TARGET))
colnames(SpeciesPerMonth) <-c("MONTH", "TOTAL")
# SpeciesPerMonth$MONTH <- as.integer(SpeciesPerMonth$MONTH)
#
# MONTHLIST <- data.frame(MONTH = c(1:12))
#
# temporalSpeciesData <- left_join(MONTHLIST, SpeciesPerMonth)
#
# temporalSpeciesData[is.na(temporalSpeciesData)] <- 0
print(ggplot(SpeciesPerMonth, aes(x = MONTH, y = TOTAL)) +
geom_bar(stat = "identity") +
ylab(Yaxistitle) )
# Graph total number of fish in each siteType
ikanTotal <- data1 %>%
group_by(SITE_TYPE) %>%
summarise(TOTAL_FISH = sum(MAXN_TARGET))
print(ggplot(data=ikanTotal, aes(x=SITE_TYPE, y=TOTAL_FISH, fill = SITE_TYPE)) +
geom_bar(stat="identity", color = "black") +
xlab("Jenis Mangrove") +
ylab(paste("Jumlah Ikan", Yaxistitle)) +
geom_text(aes(label=TOTAL_FISH), vjust=-0.3, size=3.5) +
theme_minimal() +
scale_fill_manual(values = c("#b41515", "#ffff00", "#0474c4"),
labels = c("Dihancur","EMR", "Alami")) +
theme(legend.title=element_blank()))
}
}
plot(x = 1,
type = "n",
xlim = c(0, 100),
ylim = c(0, 10),
pch = 16,
xlab = "Vegitation",
ylab = "Total Species")
# Add coral2 points for male data
points(x = URUV_data$VEGITATION[URUV_data$SITE_TYPE == "D"],
y = URUV_data$NO_ALLSPECIES[URUV_data$SITE_TYPE == "D"],
pch = 16,
col = "coral2", trans.val = .8)
# Add steelblue points for female data
points(x = URUV_data$VEGITATION[URUV_data$SITE_TYPE == "E"],
y = URUV_data$NO_ALLSPECIES[URUV_data$SITE_TYPE == "E"],
pch = 16,
col = "steelblue3", trans.val = .8)
points(x = URUV_data$VEGITATION[URUV_data$SITE_TYPE == "L"],
y = URUV_data$NO_ALLSPECIES[URUV_data$SITE_TYPE == "L"],
pch = 16,
col = "chartreuse2", trans.val = .8)
plot(x = 1,
type = "n",
xlim = c(0, 100),
ylim = c(0, 10),
pch = 16,
xlab = "Vegitation",
ylab = "Total Species")
# Add coral2 points for degraded data
points(x = URUV_data$VEGITATION[URUV_data$SITE_TYPE == "D"],
y = URUV_data$NO_FISHSPECIES[URUV_data$SITE_TYPE == "D"],
pch = 16,
col = "coral2", trans.val = .8)
# Add steelblue points for EMR data
points(x = URUV_data$VEGITATION[URUV_data$SITE_TYPE == "E"],
y = URUV_data$NO_FISHSPECIES[URUV_data$SITE_TYPE == "E"],
pch = 16,
col = "steelblue3", trans.val = .8)
#Green points for lush data
points(x = URUV_data$VEGITATION[URUV_data$SITE_TYPE == "L"],
y = URUV_data$NO_FISHSPECIES[URUV_data$SITE_TYPE == "L"],
pch = 16,
col = "chartreuse2", trans.val = .8)
ggplot(URUV_data, aes(x=NO_BATTERY, y=TOTALTIME_RECORDING)) +
geom_bar(stat='identity')
View(URUV_data)
View(URUV_data)
preference_dataframe <- data.frame(SITE_TYPE = as.factor(c("D", "E", "L")))
View(preference_dataframe)
j <- 10
URUV_data[,j]
colnames(URUV_data[,j])
print()
URUV_data[,j]
print(URUV_data[,j])
colnames(URUV_data[j])
#TotalMaxN and Shannon's Diversity for each observation
dontInclude <- c("UNIDGUPPY", "PIPEFISH", "TOTAL")
preference_dataframe <- data.frame(SITE_TYPE = as.factor(c("D", "E", "L")))
# for(i in 1:nrow(URUV_data)){
#   species_counts <- c()
#   k <- 1
for(j in 1:ncol(URUV_data)){
if(grepl(paste(dontInclude, collapse = "|"), colnames(URUV_data[j])) == FALSE & grepl("MAXN", colnames(URUV_data[j])) & URUV_data[i,j] > 0){
tot_obs <- sum(URUV_data[,j])
prop <- URUV_data %>%
group_by(SITE_TYPE)%>%
summarise(paste0('prop_',colnames(URUV_data[j])) = (sum(URUV_data[,j])/tot_obs))
j <- 19
URUV_data[,j]
j <- 30
URUV_data[,j]
View(URUV_data)
paste0('prop_',colnames(URUV_data[j]))
library(rlang)
# for(i in 1:nrow(URUV_data)){
#   species_counts <- c()
#   k <- 1
for(j in 1:ncol(URUV_data)){
if(grepl(paste(dontInclude, collapse = "|"), colnames(URUV_data[j])) == FALSE & grepl("MAXN", colnames(URUV_data[j])) & URUV_data[i,j] > 0){
tot_obs <- sum(URUV_data[,j])
prop <- URUV_data %>%
group_by(SITE_TYPE)%>%
summarise(!!paste0('prop_',colnames(URUV_data[j])) = (sum(URUV_data[,j])/tot_obs))
# for(i in 1:nrow(URUV_data)){
#   species_counts <- c()
#   k <- 1
for(j in 1:ncol(URUV_data)){
if(grepl(paste(dontInclude, collapse = "|"), colnames(URUV_data[j])) == FALSE & grepl("MAXN", colnames(URUV_data[j])) & URUV_data[i,j] > 0){
tot_obs <- sum(URUV_data[,j])
prop <- URUV_data %>%
group_by(SITE_TYPE)%>%
summarise(!!paste0('prop_',colnames(URUV_data[j])) := (sum(URUV_data[,j])/tot_obs))
print(prop)
}
}
colnames(URUV_data[50])
j <- 50
tot_obs <- sum(URUV_data[,j])
prop <- URUV_data %>%
group_by(SITE_TYPE)%>%
summarise(!!paste0('prop_',colnames(URUV_data[j])) := (sum(URUV_data[,j])/tot_obs))
prop
tot_obs
sum(URUV_data[,j])
j <- 50
tot_obs <- sum(URUV_data[,j])
calc_df <- data.frame(SITE_TYPE = URUV_data$SITE_TYPE,
SPECIES = URUV_data[j])
View(calc_df)
prop <- calc_df %>%
group_by(SITE_TYPE)%>%
summarise(!!paste0('prop_',colnames(URUV_data[j])) := (sum(SPECIES)/tot_obs))
prop <- calc_df %>%
group_by(SITE_TYPE)%>%
summarize(wft = (sum(SPECIES)/tot_obs))#summarise(!!paste0('prop_',colnames(URUV_data[j])) := (sum(SPECIES)/tot_obs))
tot_obs <- sum(URUV_data[,j])
calc_df <- data.frame(SITE_TYPE = URUV_data$SITE_TYPE,
SPECIES = URUV_data[,j])
prop <- calc_df %>%
group_by(SITE_TYPE)%>%
summarize(wft = (sum(SPECIES)/tot_obs))#summarise(!!paste0('prop_',colnames(URUV_data[j])) := (sum(SPECIES)/tot_obs))
print(prop)
View(prop)
tot_obs <- sum(URUV_data[,j])
calc_df <- data.frame(SITE_TYPE = URUV_data$SITE_TYPE,
SPECIES = URUV_data[,j])
prop <- calc_df %>%
group_by(SITE_TYPE)%>%
summarise(!!paste0('prop_',colnames(URUV_data[j])) := (sum(SPECIES)/tot_obs))
print(prop)
prop
View(prop)
prop <- calc_df %>%
group_by(SITE_TYPE)%>%
summarise(!!paste0('prop_',colnames(URUV_data[j])) := sum(SPECIES))#(sum(SPECIES)/tot_obs))
View(prop)
#TotalMaxN and Shannon's Diversity for each observation
dontInclude <- c("UNIDGUPPY", "PIPEFISH", "TOTAL")
preference_dataframe <- data.frame(SITE_TYPE = as.factor(c("D", "E", "L")))
# for(i in 1:nrow(URUV_data)){
#   species_counts <- c()
#   k <- 1
for(j in 1:ncol(URUV_data)){
if(grepl(paste(dontInclude, collapse = "|"), colnames(URUV_data[j])) == FALSE & grepl("MAXN", colnames(URUV_data[j])) & URUV_data[i,j] > 0){
tot_obs <- sum(URUV_data[,j])
calc_df <- data.frame(SITE_TYPE = URUV_data$SITE_TYPE,
SPECIES = URUV_data[,j])
prop <- calc_df %>%
group_by(SITE_TYPE)%>%
summarise(!!paste0('prop_',colnames(URUV_data[j])) := (sum(SPECIES)/tot_obs))
species_preferences <- cbind(preference_dataframe, prop, by = SITE_TYPE)
}
}
#TotalMaxN and Shannon's Diversity for each observation
dontInclude <- c("UNIDGUPPY", "PIPEFISH", "TOTAL")
preference_dataframe <- data.frame(SITE_TYPE = as.factor(c("D", "E", "L")))
# for(i in 1:nrow(URUV_data)){
#   species_counts <- c()
#   k <- 1
for(j in 1:ncol(URUV_data)){
if(grepl(paste(dontInclude, collapse = "|"), colnames(URUV_data[j])) == FALSE & grepl("MAXN", colnames(URUV_data[j])) & URUV_data[i,j] > 0){
tot_obs <- sum(URUV_data[,j])
calc_df <- data.frame(SITE_TYPE = URUV_data$SITE_TYPE,
SPECIES = URUV_data[,j])
prop <- calc_df %>%
group_by(SITE_TYPE)%>%
summarise(!!paste0('prop_',colnames(URUV_data[j])) := (sum(SPECIES)/tot_obs))
#species_preferences <- cbind(preference_dataframe, prop, by = SITE_TYPE)
}
}
#TotalMaxN and Shannon's Diversity for each observation
dontInclude <- c("UNIDGUPPY", "PIPEFISH", "TOTAL")
preference_dataframe <- data.frame(SITE_TYPE = as.factor(c("D", "E", "L")))
# for(i in 1:nrow(URUV_data)){
#   species_counts <- c()
#   k <- 1
for(j in 1:ncol(URUV_data)){
if(grepl(paste(dontInclude, collapse = "|"), colnames(URUV_data[j])) == FALSE & grepl("MAXN", colnames(URUV_data[j])) & URUV_data[i,j] > 0){
tot_obs <- sum(URUV_data[,j])
calc_df <- data.frame(SITE_TYPE = URUV_data$SITE_TYPE,
SPECIES = URUV_data[,j])
prop <- calc_df %>%
group_by(SITE_TYPE)%>%
summarise(!!paste0('prop_',colnames(URUV_data[j])) := (sum(SPECIES)/tot_obs))
#species_preferences <- cbind(preference_dataframe, prop, by = SITE_TYPE)
}
}
j <- 50
if(grepl(paste(dontInclude, collapse = "|"), colnames(URUV_data[j])) == FALSE & grepl("MAXN", colnames(URUV_data[j])) & URUV_data[i,j] > 0){
tot_obs <- sum(URUV_data[,j])
calc_df <- data.frame(SITE_TYPE = URUV_data$SITE_TYPE,
SPECIES = URUV_data[,j])
prop <- calc_df %>%
group_by(SITE_TYPE)%>%
summarise(!!paste0('prop_',colnames(URUV_data[j])) := (sum(SPECIES)/tot_obs))
#species_preferences <- cbind(preference_dataframe, prop, by = SITE_TYPE)
}
tot_obs <- sum(URUV_data[,j])
calc_df <- data.frame(SITE_TYPE = URUV_data$SITE_TYPE,
SPECIES = URUV_data[,j])
prop <- calc_df %>%
group_by(SITE_TYPE)%>%
summarise(!!paste0('prop_',colnames(URUV_data[j])) := (sum(SPECIES)/tot_obs))
# for(i in 1:nrow(URUV_data)){
#   species_counts <- c()
#   k <- 1
for(j in 1:ncol(URUV_data)){
if(grepl(paste(dontInclude, collapse = "|"), colnames(URUV_data[j])) == FALSE & grepl("MAXN", colnames(URUV_data[j]))){
tot_obs <- sum(URUV_data[,j])
calc_df <- data.frame(SITE_TYPE = URUV_data$SITE_TYPE,
SPECIES = URUV_data[,j])
prop <- calc_df %>%
group_by(SITE_TYPE)%>%
summarise(!!paste0('prop_',colnames(URUV_data[j])) := (sum(SPECIES)/tot_obs))
#species_preferences <- cbind(preference_dataframe, prop, by = SITE_TYPE)
}
}
#TotalMaxN and Shannon's Diversity for each observation
dontInclude <- c("UNIDGUPPY", "PIPEFISH", "TOTAL")
preference_dataframe <- data.frame(SITE_TYPE = as.factor(c("D", "E", "L")))
# for(i in 1:nrow(URUV_data)){
#   species_counts <- c()
#   k <- 1
for(j in 1:ncol(URUV_data)){
if(grepl(paste(dontInclude, collapse = "|"), colnames(URUV_data[j])) == FALSE & grepl("MAXN", colnames(URUV_data[j]))){
tot_obs <- sum(URUV_data[,j])
calc_df <- data.frame(SITE_TYPE = URUV_data$SITE_TYPE,
SPECIES = URUV_data[,j])
prop <- calc_df %>%
group_by(SITE_TYPE)%>%
summarise(!!paste0('prop_',colnames(URUV_data[j])) := (sum(SPECIES)/tot_obs))
species_preferences <- cbind(preference_dataframe, prop, by = SITE_TYPE)
}
}
#TotalMaxN and Shannon's Diversity for each observation
dontInclude <- c("UNIDGUPPY", "PIPEFISH", "TOTAL")
preference_dataframe <- data.frame(SITE_TYPE = as.factor(c("D", "E", "L")))
# for(i in 1:nrow(URUV_data)){
#   species_counts <- c()
#   k <- 1
for(j in 1:ncol(URUV_data)){
if(grepl(paste(dontInclude, collapse = "|"), colnames(URUV_data[j])) == FALSE & grepl("MAXN", colnames(URUV_data[j]))){
tot_obs <- sum(URUV_data[,j])
calc_df <- data.frame(SITE_TYPE = URUV_data$SITE_TYPE,
SPECIES = URUV_data[,j])
prop <- calc_df %>%
group_by(SITE_TYPE)%>%
summarise(!!paste0('prop_',colnames(URUV_data[j])) := (sum(SPECIES)/tot_obs))
species_preferences <- cbind(preference_dataframe, prop, by = 'SITE_TYPE')
}
}
View(species_preferences)
#TotalMaxN and Shannon's Diversity for each observation
dontInclude <- c("UNIDGUPPY", "PIPEFISH", "TOTAL")
preference_dataframe <- data.frame(SITE_TYPE = as.factor(c("D", "E", "L")))
# for(i in 1:nrow(URUV_data)){
#   species_counts <- c()
#   k <- 1
for(j in 1:ncol(URUV_data)){
if(grepl(paste(dontInclude, collapse = "|"), colnames(URUV_data[j])) == FALSE & grepl("MAXN", colnames(URUV_data[j]))){
tot_obs <- sum(URUV_data[,j])
calc_df <- data.frame(SITE_TYPE = URUV_data$SITE_TYPE,
SPECIES = URUV_data[,j])
prop <- calc_df %>%
group_by(SITE_TYPE)%>%
summarise(!!paste0('prop_',colnames(URUV_data[j])) := (sum(SPECIES)/tot_obs))
preference_dataframe <- cbind(preference_dataframe, prop, by = 'SITE_TYPE')
}
}
#TotalMaxN and Shannon's Diversity for each observation
dontInclude <- c("UNIDGUPPY", "PIPEFISH", "TOTAL")
preference_dataframe <- data.frame(SITE_TYPE = c("D", "E", "L"))
# for(i in 1:nrow(URUV_data)){
#   species_counts <- c()
#   k <- 1
for(j in 1:ncol(URUV_data)){
if(grepl(paste(dontInclude, collapse = "|"), colnames(URUV_data[j])) == FALSE & grepl("MAXN", colnames(URUV_data[j]))){
tot_obs <- sum(URUV_data[,j])
calc_df <- data.frame(SITE_TYPE = URUV_data$SITE_TYPE,
SPECIES = URUV_data[,j])
prop <- calc_df %>%
group_by(SITE_TYPE)%>%
summarise(!!paste0('prop_',colnames(URUV_data[j])) := (sum(SPECIES)/tot_obs))
preference_dataframe <- cbind(preference_dataframe, prop, by = 'SITE_TYPE')
}
}
#TotalMaxN and Shannon's Diversity for each observation
dontInclude <- c("UNIDGUPPY", "PIPEFISH", "TOTAL")
preference_dataframe <- data.frame(SITE_TYPE = c("D", "E", "L"))
# for(i in 1:nrow(URUV_data)){
#   species_counts <- c()
#   k <- 1
for(j in 1:ncol(URUV_data)){
if(grepl(paste(dontInclude, collapse = "|"), colnames(URUV_data[j])) == FALSE & grepl("MAXN", colnames(URUV_data[j]))){
tot_obs <- sum(URUV_data[,j])
calc_df <- data.frame(SITE_TYPE = URUV_data$SITE_TYPE,
SPECIES = URUV_data[,j])
prop <- calc_df %>%
group_by(SITE_TYPE)%>%
summarise(!!paste0('prop_',colnames(URUV_data[j])) := (sum(SPECIES)/tot_obs))
preference_dataframe <- left_join(preference_dataframe, prop, by = 'SITE_TYPE')
}
}
#TotalMaxN and Shannon's Diversity for each observation
dontInclude <- c("UNIDGUPPY", "PIPEFISH", "TOTAL")
preference_dataframe <- data.frame(SITE_TYPE = as.factor(c("D", "E", "L")))
# for(i in 1:nrow(URUV_data)){
#   species_counts <- c()
#   k <- 1
for(j in 1:ncol(URUV_data)){
if(grepl(paste(dontInclude, collapse = "|"), colnames(URUV_data[j])) == FALSE & grepl("MAXN", colnames(URUV_data[j]))){
tot_obs <- sum(URUV_data[,j])
calc_df <- data.frame(SITE_TYPE = URUV_data$SITE_TYPE,
SPECIES = URUV_data[,j])
prop <- calc_df %>%
group_by(SITE_TYPE)%>%
summarise(!!paste0('prop_',colnames(URUV_data[j])) := (sum(SPECIES)/tot_obs))
preference_dataframe <- left_join(preference_dataframe, prop, by = 'SITE_TYPE')
}
}
preference_dataframe$totProps <- rowSums(preference_dataframe)
preference_dataframe$totProps <- rowSums(preference_dataframe[,2:ncol(preference_dataframe)])
#TotalMaxN and Shannon's Diversity for each observation
dontInclude <- c("UNIDGUPPY", "PIPEFISH", "TOTAL")
preference_dataframe <- data.frame(SITE_TYPE = as.factor(c("D", "E", "L")))
# for(i in 1:nrow(URUV_data)){
#   species_counts <- c()
#   k <- 1
for(j in 1:ncol(URUV_data)){
if(grepl(paste(dontInclude, collapse = "|"), colnames(URUV_data[j])) == FALSE & grepl("MAXN", colnames(URUV_data[j]))){
tot_obs <- sum(URUV_data[,j])
calc_df <- data.frame(SITE_TYPE = URUV_data$SITE_TYPE,
SPECIES = URUV_data[,j])
prop <- calc_df %>%
group_by(SITE_TYPE)%>%
summarise(!!paste0('prop_',colnames(URUV_data[j])) := (sum(SPECIES)/tot_obs))
preference_dataframe <- left_join(preference_dataframe, prop, by = 'SITE_TYPE')
}
}
preference_dataframe$totProps <- rowSums(preference_dataframe[,2:ncol(preference_dataframe)])
ggplot(data=preference_dataframe, aes(x=SITE_TYPE, y=totProps, fill = SITE_TYPE)) +
geom_bar(stat="identity", color = "black") +
xlab("Jenis Mangrove") +
ylab("Index") +
#geom_text(aes(label=SHANNON_AVG), vjust=-0.3, size=3.5) +
theme_minimal() +
scale_fill_manual(values = c("#b41515", "#ffff00", "#0474c4"),
labels = c("Dihancur","EMR", "Alami")) +
theme(legend.title=element_blank())
